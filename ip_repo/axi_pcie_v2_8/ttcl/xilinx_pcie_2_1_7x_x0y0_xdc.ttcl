<#: ttcl/GetValueSimParam.ttcl :>
<: if {!$gen_x0y0_ucf} ttcl_return :>
<: setFileName $xdc_name :>
<: setFileExtension ".xdc" :>
<: setOutputDirectory [ttcl_add $ComponentName "/example_design"] :>
<#: ttcl/header.ttcl :>
#
###############################################################################
# User Configuration 
# Link Width   - x<=: print $max_lnk_wdt_int :>
# Link Speed   - gen<=: ttcl_add $max_lnk_spd_int 1 :>
# Family       - <=: print $prj_fam :>
# Part         - <=: print $prj_dev :>
# Package      - <=: print $prj_pkg :>
# Speed grade  - <=: print $prj_spd_grd :>
# PCIe Block   - <=: print $pcie_blk :>
###############################################################################
# User Time Names / User Time Groups / Time Specs
###############################################################################

###############################################################################
# User Physical Constraints
###############################################################################


###############################################################################
# Pinout and Related I/O Constraints
###############################################################################

#
# SYS reset (input) signal.  The sys_reset_n signal should be
# obtained from the PCI Express interface if possible.  For
# slot based form factors, a system reset signal is usually
# present on the connector.  For cable based form factors, a
# system reset signal may not be available.  In this case, the
# system reset signal must be generated locally by some form of
# supervisory circuit.  You may change the IOSTANDARD and LOC
# to suit your requirements and VCCO voltage banking rules.
# Some 7 series devices do not have 3.3 V I/Os available.
# Therefore the appropriate level shift is required to operate
# with these devices that contain only 1.8 V banks.
#
#
<: if {[string equal -nocase $prj_fam "zynq"] && $part_is_xc7z045 && $pkg_is_ffg900} { :>
set_property IOSTANDARD LVCMOS15 [get_ports sys_rst_n]
<: } elseif {[string equal -nocase $prj_fam "virtex7"] && $part_is_xc7vx485t && ($pkg_is_ffg1761 || $pkg_is_ffg1157)} { :>
set_property IOSTANDARD LVCMOS18 [get_ports sys_rst_n]
<: } elseif {[starts_with $prj_fam "kintex7"] && ((($part_is_xc7k325t || $part_is_xc7k325tl) && $pkg_is_ffg900) || (($part_is_xq7k325t || $part_is_xq7k325tl) && $pkg_is_rf900))} { :>
set_property IOSTANDARD LVCMOS25 [get_ports sys_rst_n]
<: } elseif {[starts_with $prj_fam "artix7"] && ($part_is_xc7a200t || $part_is_xc7a200tl) && $pkg_is_fbg676} { :>
set_property IOSTANDARD LVCMOS33 [get_ports sys_rst_n]
<: } elseif {[starts_with $prj_fam "artix7"] } { :>
set_property IOSTANDARD LVCMOS33 [get_ports sys_rst_n]
<: } :>
<: if {[string equal -nocase $prj_fam "zynq"] && $part_is_xc7z045 && $pkg_is_ffg900} { :>
set_property LOC AK23 [get_ports sys_rst_n]
<: } elseif {[string equal -nocase $prj_fam "virtex7"] && $part_is_xc7vx485t && $pkg_is_ffg1761} { :>
set_property LOC AV35 [get_ports sys_rst_n]
<: } elseif {[string equal -nocase $prj_fam "virtex7"] && $part_is_xc7vx485t && $pkg_is_ffg1157} { :>
set_property LOC AF24 [get_ports sys_rst_n]
<: } elseif {[starts_with $prj_fam "kintex7"] && ((($part_is_xc7k325t || $part_is_xc7k325tl) && $pkg_is_ffg900) || (($part_is_xq7k325t || $part_is_xq7k325tl) && $pkg_is_rf900))} { :>
set_property LOC G25 [get_ports sys_rst_n]
<: } elseif {[starts_with $prj_fam "artix7"]} { :>
<: if {($part_is_xc7a200t || $part_is_xc7a200tl) && $pkg_is_fbg676} { :>
set_property LOC M20 [get_ports sys_rst_n]
<: } elseif {($part_is_xc7a35t || $part_is_xc7a35tl || $part_is_xa7a35t || $part_is_xc7a50t || $part_is_xc7a50tl || $part_is_xa7a50t || $part_is_xq7a50t || $part_is_xc7a15t || $part_is_xa7a15t) && $pkg_is_cpg236} { :>
set_property LOC P1 [get_ports sys_rst_n]
<: } elseif {($part_is_xc7a35t || $part_is_xc7a35tl || $part_is_xa7a35t || $part_is_xc7a50t || $part_is_xc7a50tl || $part_is_xa7a50t || $part_is_xq7a50t || $part_is_xc7a15t || $part_is_xa7a15t) && $pkg_is_csg325} { :>
set_property LOC R6 [get_ports sys_rst_n]
<: } :>
<: } :>

###############################################################################
# Physical Constraints
###############################################################################
#
# SYS clock <=: ref_clk_freq :> MHz (input) signal. The sys_clk_p and sys_clk_n
# signals are the PCI Express reference clock. Virtex-7 GT
# Transceiver architecture requires the use of a dedicated clock
# resources (FPGA input pins) associated with each GT Transceiver.
# To use these pins an IBUFDS primitive (refclk_ibuf) is
# instantiated in user's design.
# Please refer to the Virtex-7 GT Transceiver User Guide
# (UG) for guidelines regarding clock resource selection.
#

<: if {$xlnx_ref_board_kc705_reva} {  :>
set_property LOC IBUFDS_GTE2_X0Y3 [get_cells refclk_ibuf]
<: } elseif  {$xlnx_ref_board_kc705_revb || $xlnx_ref_board_kc705_revc}  { :>
set_property LOC IBUFDS_GTE2_X0Y1 [get_cells refclk_ibuf]
<: } elseif {$xlnx_ref_board_zc706} { :>
set_property LOC IBUFDS_GTE2_X0Y6 [get_cells refclk_ibuf]
<: } elseif {$xlnx_ref_board_ac701} { :>
set_property LOC IBUFDS_GTE2_X0Y2 [get_cells refclk_ibuf]
<: } else { :>
<: if {[starts_with $prj_dev "xc7a35t"] || [starts_with $prj_dev "xc7a50t"] || [starts_with $prj_dev "xa7a35t"] || [starts_with $prj_dev "xa7a50t"] || [starts_with $prj_dev "xq7a50t"] || [starts_with $prj_dev "xc7a75t"] || [starts_with $prj_dev "xa7a75t"] || [starts_with $prj_dev "xc7a15t"] || [starts_with $prj_dev "xa7a15t"]} { :>
<: if {([starts_with $prj_dev "xc7a75t"] || [starts_with $prj_dev "xa7a75t"] )} { :>
set_property LOC IBUFDS_GTE2_X0Y2 [get_cells refclk_ibuf]
<: } else { :>
set_property LOC IBUFDS_GTE2_X0Y0 [get_cells refclk_ibuf]
<: } :>
<: } else { :>
set_property LOC IBUFDS_GTE2_X0Y<=: expr {($x0y0_ln0 - 1) / 2} :> [get_cells refclk_ibuf]
<: } :>
<: } :>

set_property PULLUP true [get_ports sys_rst_n]
set_false_path -from [get_ports sys_rst_n]

###############################################################################
# Timing Constraints
###############################################################################
#
<: ;#Set the frequncy on the received reference clock :>
create_clock -name sys_clk -period <=: ref_clk_prd :> [get_ports sys_clk_p]
#
<: if {$pcie_ext_clk_string == "TRUE"}  { :>
<#: ttcl/Timing_Constraints_xdc.ttcl :>
<: } :>
#
###############################################################################
# Physical Constraints
###############################################################################
<: if { $pcie_ext_gt_common_string == "TRUE"} { :>
<: if {[starts_with $prj_fam "artix7"] || [starts_with $prj_fam "qartix7"] || [starts_with $prj_fam "aartix7"] || ([starts_with $prj_fam "zynq"] && [starts_with $prj_dev "xc7z015"])} {  :>
<: ;# Artix GTP :>
set_false_path -through [get_pins -hierarchical -filter {NAME=~*/PLL0LOCK}]
<: } else { :>
<: ;# Kintex/Virtex GTX :>
set_false_path -through [get_pins -hierarchical -filter {NAME=~*/QPLLLOCK}]
<: } :>
<: } :>
###############################################################################
# End
###############################################################################
